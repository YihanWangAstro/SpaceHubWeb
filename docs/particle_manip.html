<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Particle manipulation | SpaceHub</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark.css" />
  <link rel="stylesheet" href="m-documentation.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m"><img src="logo.png" />SpaceHub</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="start.html">Getting started</a></li>
            <li><a href="tutorial.html">Tutorial</a></li>
            <li><a href="annotated.html">Classes</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="4">
            <li><a href="files.html">Files</a></li>
            <li><a href="tests.html">Tests</a></li>
            <li><a href="versions.html">Versions</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          Particle manipulation
        </h1>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li><a href="#particle">Use the Particle System</a></li>
            <li><a href="#move_particle1">Move the particles</a></li>
            <li><a href="#move_kepler">Move particles to Kepler orbit</a></li>
            <li><a href="#examples">Examples</a></li>
          </ul>
        </div>
<section id="particle"><h2><a href="#particle">Use the Particle System</a></h2><p>By default, SpaceHub provides you a particle type to create initial conditions. The default type provides you,</p><ul><li><strong class="m-label m-flat m-info">mass</strong> The mass of particle.</li><li><strong class="m-label m-flat m-info">radius</strong> The radius of the particle.</li><li><strong class="m-label m-flat m-info">pos</strong> The position of the particle. 3D vector with (x,y,z) components.</li><li><strong class="m-label m-flat m-info">vel</strong> The velocity of the particle. 3D vector with (x,y,z) components.</li></ul><p>The particle type is associated with the simulator type, so you can get the particle type by from the Simulator type.</p><pre class="m-code"> <span class="p">...</span>
 <span class="c1">//import the unit system of spaceHub</span>
 <span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">unit</span><span class="p">;</span>
 <span class="c1">//Use the associated particle type of the default simulator of SpaceHub</span>
 <span class="k">using</span> <span class="n">Particle</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">DefaultSolver</span><span class="o">::</span><span class="n">Particle</span><span class="p">;</span>
 <span class="p">...</span>
 <span class="c1">//1.Create particle without any parameter, mass = 0, radius = 0.</span>
 <span class="n">Particle</span> <span class="n">particle1</span><span class="p">;</span>
 <span class="n">particle1</span><span class="p">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mi">1</span><span class="n">_Ms</span><span class="p">;</span>
 <span class="n">particle1</span><span class="p">.</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">1</span><span class="n">_Rs</span><span class="p">;</span>
 <span class="p">...</span>
 <span class="c1">//2. Create a particle with 8 parameters.</span>
 <span class="c1">//</span>
 <span class="c1">//                               px     py     pz    vx     vy      vz</span>
 <span class="c1">//                               |      |      |     |      |       |</span>
 <span class="n">Particle</span> <span class="n">particle2</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">,</span> <span class="mi">1</span><span class="n">_Rs</span><span class="p">,</span> <span class="mi">1</span><span class="n">_AU</span><span class="p">,</span> <span class="mf">0.4</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">0</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">2</span><span class="n">_kms</span><span class="p">,</span> <span class="mi">-3</span><span class="n">_kms</span><span class="p">,</span> <span class="mi">0</span><span class="n">_kms</span><span class="p">);</span>

<span class="c1">//Use the embedded 3d Vector type of the Particle.</span>
 <span class="k">using</span> <span class="n">Vector</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">Particle</span><span class="o">::</span><span class="n">Vector</span><span class="p">;</span>

<span class="c1">//define the position and velocity vectors.</span>
 <span class="n">Vector</span> <span class="nf">pos</span><span class="p">(</span><span class="mi">3</span><span class="n">_PC</span><span class="p">,</span> <span class="mf">2.5</span><span class="n">_PC</span><span class="p">,</span><span class="mi">-4</span><span class="n">_Pc</span><span class="p">),</span> <span class="n">vel</span><span class="p">(</span><span class="mf">0.2</span><span class="n">_kms</span><span class="p">,</span> <span class="mf">-1.2</span><span class="n">_kms</span><span class="p">,</span> <span class="mi">3</span><span class="n">_kms</span><span class="p">)</span>

<span class="c1">//3. Create a particle with mass, radius, position and velocity.</span>
 <span class="n">Particle</span> <span class="n">particle3</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">,</span> <span class="mi">1</span><span class="n">_Rs</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">vel</span><span class="p">);</span>

<span class="c1">//4. create a particle without providing the position and velocity. Then the position and velocity will be (0,0,0) and (0,0,0);</span>
 <span class="n">Particle</span> <span class="nf">particle4</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">,</span> <span class="mi">1</span><span class="n">_Rs</span><span class="p">);</span></pre><p>See also <a href="classspace_1_1particle__set_1_1_size_particles.html#a585879886c0364d83c434058f38132af" class="m-doc">space::<wbr />particle_set::<wbr />SizeParticles::<wbr />Particle</a>, which is the default particle type.</p></section><section id="move_particle1"><h2><a href="#move_particle1">Move the particles</a></h2><p>Indeed, what makes you much easier to create the initial conditions are the four powerful functions provided by SpaceHub.</p><ul><li><a href="namespacespace_1_1orbit.html#a9ce15ee351be8dcc5b55294381b24d95" class="m-doc">space::<wbr />orbit::<wbr />move_particles_pos</a></li><li><a href="namespacespace_1_1orbit.html#a02faa6ac98764495a3fadfd8812d6d2d" class="m-doc">space::<wbr />orbit::<wbr />move_particles_vel</a></li><li><a href="namespacespace_1_1orbit.html#a7e2e611df033fb699f00e4d145a5b40e" class="m-doc">space::<wbr />orbit::<wbr />move_particles</a></li><li><a href="namespacespace_1_1orbit.html#ab6e8ae7f7ad9035524595a2d1b540a85" class="m-doc">space::<wbr />orbit::<wbr />move_to_COM_frame</a></li></ul><p>Associated with the Kepler orbit we introduced in last tutorial, you can create any initial conditions in a very easy way.</p><p>First, we will introduce you <code>move_particles_pos</code> and <code>move_particles_vel</code>, which are used to move the particles to a specific position or velocity. The two functions accept arbitrary number of arguments, the first is the target position/velocity you want to move to and the rests are the particles you are going to move.</p><pre class="m-code"><span class="p">...</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">unit</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">orbit</span><span class="p">;</span><span class="c1">//import the functions above.</span>
<span class="k">using</span> <span class="n">Particle</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">DefaultSolver</span><span class="o">::</span><span class="n">Particle</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Vector</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">Particle</span><span class="o">::</span><span class="n">Vector</span><span class="p">;</span>
<span class="p">...</span>

<span class="c1">//All the three particles are rest at origin.</span>
<span class="n">Particle</span> <span class="n">p1</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">,</span> <span class="mi">1</span><span class="n">_Rs</span><span class="p">),</span> <span class="n">p2</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">,</span> <span class="mi">3</span><span class="n">_km</span><span class="p">),</span> <span class="n">p3</span><span class="p">(</span><span class="mf">1.4</span><span class="n">_Ms</span><span class="p">,</span> <span class="mi">10</span><span class="n">_km</span><span class="p">);</span>

<span class="c1">//move particle p1 to (1_AU, 2_AU, 0) which is equivalent to  p1.pos = Vector(1_AU, 2_AU, 0).</span>
<span class="n">move_particles_pos</span><span class="p">(</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">2</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p1</span><span class="p">);</span>
<span class="c1">//move particle p2 to (5_AU, 0, -3_AU).</span>
<span class="n">move_particles_pos</span><span class="p">(</span><span class="n">Vector</span><span class="p">(</span><span class="mi">5</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">-3</span><span class="n">_AU</span><span class="p">),</span> <span class="n">p2</span><span class="p">);</span>

<span class="c1">//move the *centre of mass* of p1 and p2 to (-10_AU, 2_AU, 3_AU) and *keep their relative position*</span>
<span class="n">move_particles_pos</span><span class="p">(</span><span class="n">Vector</span><span class="p">(</span><span class="mi">-10</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">2</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">3</span><span class="n">_AU</span><span class="p">),</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">);</span>

<span class="c1">//move_the centre of mass of p1, p2 and p3 to origin equivalent.</span>
<span class="n">move_particles_pos</span><span class="p">(</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span></pre><p>You can do the same things with <code>move_particles_vel</code> to move the velocities of the particles by providing the target velocity in 3D vector. The way that SpaceHub saves your time here is providing you a way to move a bulk of particles at the same time with keeping their relative position unchanged.</p><p>The function <code>move_particles</code> is designed to move the position and velocity at the same time. The first argument is the target position, the second argument is the target velocity and the rest are the particles you are going to move. You can do it in this way,</p><pre class="m-code"><span class="p">...</span>

<span class="c1">//move the *centre of mass* of p1, p2 and p3 to (-10_AU, 2_AU, 3_AU) and the centre of mass velocity to (2_km, 0.3_km, -3_km)</span>
<span class="c1">// with keeping their relative position and relative velocity. Here they overlap with each other.</span>
<span class="n">move_particles_pos</span><span class="p">(</span><span class="n">Vector</span><span class="p">(</span><span class="mi">-10</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">2</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">3</span><span class="n">_AU</span><span class="p">),</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">2</span><span class="n">_km</span><span class="p">,</span> <span class="mf">0.3</span><span class="n">_km</span><span class="p">,</span> <span class="mi">-3</span><span class="n">_km</span><span class="p">),</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span></pre><p>The last function <code>move_to_COM_frame</code> is used to move a bulk of particles to the centre of mass reference frame and set the centre of mass of the particles to origin.</p><pre class="m-code"><span class="p">...</span>
<span class="n">move_to_COM_frame</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span></pre><p>If you have 100 particles need to move, it would be cumbersome to pass 100 particles as the parameter of the function above, nor to define 100 particle variables. The way, we usually do is to put the particles in an array(Container). The four functions above can also move the particles in a STL container, e.g, std::array, std::vector, std::list...</p><pre class="m-code"><span class="cp">#include</span><span class="cpf">&lt;array&gt;</span><span class="cp"></span>
<span class="p">...</span>
<span class="k">using</span> <span class="n">Particle</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">DefaultSolver</span><span class="o">::</span><span class="n">Particle</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Vector</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">Particle</span><span class="o">::</span><span class="n">Vector</span><span class="p">;</span>
<span class="p">...</span>
<span class="c1">//An array with 100 particles</span>
<span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">Particles</span><span class="p">,</span><span class="mi">100</span><span class="o">&gt;</span> <span class="n">particles</span><span class="p">;</span>
<span class="c1">//initializations on the 100 particles. we will provide specific examples later.</span>
<span class="p">...</span>
<span class="c1">//Move the 100 particles</span>
<span class="n">move_particles</span><span class="p">(</span><span class="n">Vector</span><span class="p">(</span><span class="mi">2</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="n">_kms</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">particles</span><span class="p">);</span></pre><aside class="m-block m-danger"><h3>What you can&#x27;t</h3><div><pre class="m-code"><span class="cp">#include</span><span class="cpf">&lt;array&gt;</span><span class="cp"></span>
<span class="p">...</span>
<span class="k">using</span> <span class="n">Particle</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">DefaultSolver</span><span class="o">::</span><span class="n">Particle</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Vector</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">Particle</span><span class="o">::</span><span class="n">Vector</span><span class="p">;</span>
<span class="p">...</span>
<span class="n">Particles</span> <span class="n">p1</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">,</span><span class="mi">1</span><span class="n">_Rs</span><span class="p">);</span>
<span class="c1">//An array with 100 particles</span>
<span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">Particles</span><span class="p">,</span><span class="mi">100</span><span class="o">&gt;</span> <span class="n">particles</span><span class="p">;</span>
<span class="c1">//initializations on the 100 particles. we will provide specific examples later.</span>
<span class="p">...</span>
<span class="c1">//                                             single particle  particles container</span>
<span class="c1">//                                                       |       |</span>
<span class="n">move_particles</span><span class="p">(</span><span class="n">Vector</span><span class="p">(</span><span class="mi">2</span><span class="n">_AU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="n">_kms</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">p1</span><span class="p">,</span> <span class="n">particles</span><span class="p">);</span></pre></div></aside></section><section id="move_kepler"><h2><a href="#move_kepler">Move particles to Kepler orbit</a></h2><p>The way that SpaceHub really save you from calculating complex initial conditions is to combine the move functions above with Kepler orbit in last tutorial. You can pass a orbit variable as the first parameter of <code>move_particles</code> to move the particles to the corresponding position and velocity of that orbit. For example, to create the sun-earth-moon system.</p><pre class="m-code"><span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">unit</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">orbit</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Particle</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">DefaultSolver</span><span class="o">::</span><span class="n">Particle</span><span class="p">;</span>
<span class="p">...</span>
<span class="c1">// create three particles. particles are rest at origin.</span>
<span class="n">Particle</span> <span class="n">sun</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">earth</span><span class="p">(</span><span class="mi">1</span><span class="n">_Me</span><span class="p">),</span> <span class="n">moon</span><span class="p">(</span><span class="mi">1</span><span class="n">_Mmoon</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">moon_orbit</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">earth</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">moon</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">384748</span><span class="n">_km</span> <span class="p">,</span> <span class="mf">0.0549</span><span class="p">,</span> <span class="mf">1.543</span><span class="n">_deg</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="c1">//Move the moon to the corresponding position and velocity of the moon orbit. Now the earth rest at origin and moon form a</span>
<span class="c1">//[earth, moon] system.</span>
<span class="n">move_particles</span><span class="p">(</span><span class="n">moon_orbit</span><span class="p">,</span> <span class="n">moon</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">earth_orbit</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">sun</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">earth</span><span class="p">.</span><span class="n">mass</span> <span class="o">+</span> <span class="n">moon</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">1</span><span class="n">_AU</span><span class="p">,</span> <span class="mf">0.016</span><span class="p">,</span> <span class="mf">7.155</span><span class="n">_deg</span><span class="p">,</span> <span class="mf">174.9</span><span class="n">_deg</span><span class="p">,</span> <span class="mf">288.1</span><span class="n">_deg</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="c1">// move the centre of mass of the moon and earth to the earth orbit. Now the sun rest at origin and the earth-moon system form a</span>
<span class="c1">//[sun, [earth, moon]] system.</span>
<span class="n">move_particles</span><span class="p">(</span><span class="n">earth_orbit</span><span class="p">,</span> <span class="n">earth</span><span class="p">,</span> <span class="n">moon</span><span class="p">);</span>

<span class="c1">// Move them to the centre of mass reference frame.</span>
<span class="n">move_to_COM_frame</span><span class="p">(</span><span class="n">sun</span><span class="p">,</span> <span class="n">earth</span><span class="p">,</span> <span class="n">moon</span><span class="p">);</span></pre><table class="m-table"><thead><tr><th>2D Cartons of generating [sun, [earth, moon]] system</th><th></th></tr></thead><tbody><tr><td><figure class="m-figure"><img src="SEM1.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>1. Particle sun(1_Ms), earth(1_Me), moon(1_Mmoon); </figcaption></figure><p>html tutorial/SEM2.png 2. move_particles(moon_orbit, moon); width=400px</p></td></tr><tr><td><figure class="m-figure"><img src="SEM3.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>3. move_particles(earth_orbit, earth, moon); </figcaption></figure><p>html tutorial/SEM4.png 4. move_to_COM_frame(sun, earth, moon); width=400px</p></td></tr></tbody></table><p>You should find that with <code>move_particles</code> and <code>move_to_COM_frame</code>, we can generate almost all configurations with few works. You don&#x27;t have to calculate the initial positions and velocities of all particles manually in complex geometry.</p><aside class="m-note m-info"><h4>Note</h4><p>The circle is used to illustrate the orbit but does not show the trajectory.</p></aside></section><section id="examples"><h2><a href="#examples">Examples</a></h2><p>We show you few additional examples of generating the initial condition with SpaceHub.</p><aside class="m-block m-info"><h3>Hierarchical Triple</h3><div><pre class="m-code"><span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">unit</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">orbit</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Particle</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">DefaultSolver</span><span class="o">::</span><span class="n">Particle</span><span class="p">;</span>
<span class="p">...</span>
<span class="n">Particle</span> <span class="n">m0</span><span class="p">(</span><span class="mi">30</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">m1</span><span class="p">(</span><span class="mi">20</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">m2</span><span class="p">(</span><span class="mi">30</span><span class="n">_Ms</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">inner_orbit</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">m0</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">m1</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">5</span><span class="n">_AU</span> <span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">0</span><span class="n">_deg</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">inner_orbit</span><span class="p">,</span> <span class="n">m0</span><span class="p">);</span>

<span class="n">move_to_COM_frame</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">outer_orbit</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">m2</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">m0</span><span class="p">.</span><span class="n">mass</span> <span class="o">+</span> <span class="n">m1</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">100</span><span class="n">_AU</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">67.155</span><span class="n">_deg</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">outer_orbit</span><span class="p">,</span> <span class="n">m2</span><span class="p">);</span>

<span class="n">move_to_COM_frame</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">);</span></pre><table class="m-table"><thead><tr><th>2D Cartons of generating Hierarchical Triple</th><th></th></tr></thead><tbody><tr><td><figure class="m-figure"><img src="LK1.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>1. Particle m0(30_Ms), m1(20_Ms), m2(30_Ms); </figcaption></figure><p>html tutorial/LK2.png 2. move_particles(inner_orbit, m0); width=400px</p></td></tr><tr><td><figure class="m-figure"><img src="LK3.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>3. move_to_COM_frame(m0, m1); </figcaption></figure><p>html tutorial/LK4.png 4. move_particles(outer_orbit, m2); width=400px</p></td></tr><tr><td><figure class="m-figure"><img src="LK5.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>5. move_to_COM_frame(m0, m1, m2); </figcaption></figure></td></tr></tbody></table></div></aside><aside class="m-block m-info"><h3>Binary Binary Scattering</h3><div><pre class="m-code"><span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">unit</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">orbit</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">random</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">consts</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Particle</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">DefaultSolver</span><span class="o">::</span><span class="n">Particle</span><span class="p">;</span>
<span class="p">...</span>
<span class="n">Particle</span> <span class="n">m0</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">m1</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">m2</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">m3</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">binary_orbit0</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">m0</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">m1</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">1</span><span class="n">_AU</span> <span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">binary_orbit0</span><span class="p">,</span> <span class="n">m1</span><span class="p">);</span>

<span class="n">move_to_COM_frame</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">binary_orbit1</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">m2</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">m3</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">2</span><span class="n">_AU</span> <span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">binary_orbit1</span><span class="p">,</span> <span class="n">m3</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">incident_orbit</span> <span class="o">=</span> <span class="n">HyperOrbit</span><span class="p">(</span><span class="n">m0</span><span class="p">.</span><span class="n">mass</span> <span class="o">+</span> <span class="n">m1</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">m2</span><span class="p">.</span><span class="n">mass</span> <span class="o">+</span> <span class="n">m3</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">5</span><span class="n">_kms</span><span class="p">,</span> <span class="mi">20</span><span class="n">_AU</span><span class="p">,</span> <span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="n">_AU</span><span class="p">,</span> <span class="n">Hyper</span><span class="o">::</span><span class="n">in</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">incident_orbit</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">);</span>

<span class="n">move_to_COM_frame</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">);</span></pre><table class="m-table"><thead><tr><th>2D Cartons of generating binary-binary scattering</th><th></th></tr></thead><tbody><tr><td><figure class="m-figure"><img src="bi-bi1.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>1. Particle m0(1_Ms), m1(1_Ms), m2(1_Ms), m3(1_Ms); </figcaption></figure><p>html tutorial/bi-bi2.png 2. move_particles(binary_orbit0, m1); width=400px</p></td></tr><tr><td><figure class="m-figure"><img src="bi-bi3.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>3. move_to_COM_frame(m0, m1); </figcaption></figure><p>html tutorial/bi-bi4.png 4. move_particles(binary_orbit1, m3); width=400px</p></td></tr><tr><td><figure class="m-figure"><img src="bi-bi5.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>5. move_particles(incident_orbit, m2, m3); </figcaption></figure><p>html tutorial/bi-bi6.png 6. move_to_COM_frame(m0, m1, m2, m3); width=400px</p></td></tr></tbody></table></div></aside><aside class="m-block m-info"><h3>Quadrupole around SMBH</h3><div><pre class="m-code"><span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">unit</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">orbit</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Particle</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">DefaultSolver</span><span class="o">::</span><span class="n">Particle</span><span class="p">;</span>
<span class="p">...</span>
<span class="n">Particle</span> <span class="n">m0</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">m1</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">m2</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">m3</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">M_bh</span><span class="p">(</span><span class="mf">1e6</span><span class="n">_Ms</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">bi_orbit0</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">m0</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">m1</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">1</span><span class="n">_AU</span> <span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">bi_orbit0</span><span class="p">,</span> <span class="n">m1</span><span class="p">);</span>

<span class="n">move_to_COM_frame</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">bi_orbit1</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">m2</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">m3</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">1</span><span class="n">_AU</span> <span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">bi_orbit1</span><span class="p">,</span> <span class="n">m3</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">quad_orbit</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">m0</span><span class="p">.</span><span class="n">mass</span> <span class="o">+</span> <span class="n">m1</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">m2</span><span class="p">.</span><span class="n">mass</span> <span class="o">+</span> <span class="n">m3</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">5</span><span class="n">_AU</span> <span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">quad_orbit</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">bh_orbit</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">M_bh</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_tot</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">),</span> <span class="mi">50</span><span class="n">_AU</span> <span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">bh_orbit</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">);</span>

<span class="n">move_to_COM_frame</span><span class="p">(</span><span class="n">M_bh</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">);</span></pre><table class="m-table"><thead><tr><th>2D Cartons of generating Quadrupole around SMBH</th><th></th></tr></thead><tbody><tr><td><figure class="m-figure"><img src="quad1.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>1. Particle m0(1_Ms), m1(1_Ms), m2(1_Ms), m3(1_Ms), M_bh(1e6_Ms); </figcaption></figure><p>html tutorial/quad2.png 2. move_particles(bi_orbit0, m1); width=400px</p></td></tr><tr><td><figure class="m-figure"><img src="quad3.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>3. move_to_COM_frame(m0, m1); </figcaption></figure><p>html tutorial/quad4.png 4. move_particles(bi_orbit1, m3); width=400px</p></td></tr><tr><td><figure class="m-figure"><img src="quad5.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>5. move_particles(quad_orbit, m2, m3); </figcaption></figure><p>html tutorial/quad6.png 6. move_particles(bh_orbit, m0, m1, m2, m3); width=400px</p></td></tr><tr><td><figure class="m-figure"><img src="quad7.png" alt="Image" style="width: 400px\ilinebr;" /><figcaption>7. move_to_COM_frame(M_bh, m0, m1, m2, m3); </figcaption></figure></td></tr></tbody></table></div></aside><aside class="m-block m-info"><h3>Asteroid belt</h3><div><pre class="m-code"><span class="cp">#include</span><span class="cpf">&lt;array&gt;</span><span class="cp"></span>
<span class="p">...</span> 
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">unit</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">orbit</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">space</span><span class="o">::</span><span class="n">random</span><span class="p">;</span>
<span class="k">using</span> <span class="n">Particle</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">DefaultSolver</span><span class="o">::</span><span class="n">Particle</span><span class="p">;</span>
<span class="p">...</span>
<span class="n">Particle</span> <span class="n">sun</span><span class="p">(</span><span class="mi">1</span><span class="n">_Ms</span><span class="p">),</span> <span class="n">earth</span><span class="p">(</span><span class="mi">1</span><span class="n">_Me</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">earth_orbit</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">sun</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">earth</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">1</span><span class="n">_AU</span> <span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">0</span><span class="n">_deg</span><span class="p">,</span> <span class="mi">0</span><span class="n">_deg</span><span class="p">,</span> <span class="mi">0</span><span class="n">_deg</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>

<span class="n">move_particles</span><span class="p">(</span><span class="n">earth_orbit</span><span class="p">,</span> <span class="n">earth</span><span class="p">);</span>

<span class="n">move_to_COM_frame</span><span class="p">(</span><span class="n">sun</span><span class="p">,</span> <span class="n">earth</span><span class="p">);</span>
<span class="c1">//Default mass, radius = 0;</span>
<span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">Particle</span><span class="p">,</span> <span class="mi">1000</span><span class="o">&gt;</span> <span class="n">asteroids</span><span class="p">;</span>

<span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span> <span class="nl">a</span> <span class="p">:</span> <span class="n">asteroids</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">auto</span> <span class="n">bell_orbit</span> <span class="o">=</span> <span class="n">EllipOrbit</span><span class="p">(</span><span class="n">sun</span><span class="p">.</span><span class="n">mass</span> <span class="o">+</span> <span class="n">earth</span><span class="p">.</span><span class="n">mass</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Uniform</span><span class="p">(</span><span class="mf">2.2</span><span class="n">_AU</span><span class="p">,</span> <span class="mf">3.3</span><span class="n">_AU</span><span class="p">)</span> <span class="p">,</span> <span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span> <span class="n">Uniform</span><span class="p">(</span><span class="mi">-5</span><span class="n">_deg</span><span class="p">,</span> <span class="mi">5</span><span class="n">_deg</span><span class="p">),</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">,</span> <span class="n">isotherm</span><span class="p">);</span>
  <span class="n">move_particles</span><span class="p">(</span><span class="n">bell_orbit</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
<span class="p">}</span></pre><figure class="m-figure"><img src="asteroid.png" alt="Image" style="width: 500px;" /><figcaption>Asteroid Belt </figcaption></figure></div></aside><div class="m-note m-dim m-text-center"><p><a href="create_kepler.html">&lt;&lt; Create Kepler orbit</a> | <a href="scattering.html">Scattering Experiments &gt;&gt;</a></p></div></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>SpaceHub. Created with <a href="https://doxygen.org/">Doxygen</a> 1.8.20 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
